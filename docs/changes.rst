.. _getlino.changes:

=======================
Changes in `getlino`
=======================

2020-05-04
==========
:cmd:`getlino configure` now defaults :option:`--shared-env` to the current
:envvar:`VIRTUAL_ENV` only when :option:`--clone` was given, not always.
And it creates the ``repos_base`` only then.
Without :option:`--clone`, the :option:`--shared-env` defaults to an empty string.

2020-04-07
==========
Fix typo with apt_packages of DbEngine.
Release 20.4.5 version to PyPI.

2020-04-03
==========
Remove certbot for www domain
Release 20.4.3 version to PyPI.

2020-04-03
==========
Update the virualenv usage.
Fix issue with installing mariadb for debian distribution instead of mysql


2020-01-03
==========
Add the ciao projet to KNOWN_REPOS.
Add 'sudo' to the certbot command.

Fix some issues with creating user and database with the :cmd:`getlino startsite` .

Released version 20.1 to PyPI
Released version 20.1.1 to PyPI

No need for 'sudo' for certbot command

Released version 20.1.2 to PyPI


2019-11-23
==========
When the user is not root , the :cmd:`getlino startsite` command doesn't create
the :xfile:`make_snapshot.sh` and the directory `nginx`.


2019-11-09
==========

The :xfile:`pull.sh` script generated by :cmd:`getlino configure` into the
shared virtualenv was still using the project_dir.


2019-11-07
==========

The :option:`getlino configure --https` option was appending directly to the
main :file:`/etc/crontab` file. Fixed.

Fixed some minor bugs.  For example the :option:`getlino configure --redis` option
was ignored when not running as root.

Released 19.11.0 to PyPI.

2019-11-06
==========

:cmd:`getlino configure --db-user` option
now creates the shared database user (:ticket:`3329`).
The items of :data:`getlino.utils.DB_ENGINES` are no longer named tuples but real objects with methods.


2019-10-25
==========

getlino no longer depends on cookiecutter. The separate cookiecutter-startsite
repository is no longer used because all templates are now below
:file:`getlino/templates`.

Released version 19.10.6 to PyPI (versions 19.10.3 to 19.10.5 are broken
versions, don't use them).


2019-10-08
==========

Released version 19.10.0 to PyPI.

.. program:: getlino configure

Fixed some bugs: Running :command:`getlino configure` without
:option:`--db-port` caused an error :message:`Invalid value for "--db-port":
invalid choice: . (choose from 5432, 3306, 0)`. The :option:`--db-port` option
is no longer a choice (it is not limited to these values). The :option:`--clone`
option sometimes had `True` as default value when it shouldn't.

Released version 19.10.1 to PyPI.

Found another bug: with :option:`--clone`, getlino didn't clone the repositories
using their nickname, which later caused failures when trying to install them.

Released version 19.10.2 to PyPI.

.. program:: getlino configure

Fixed some more bugs: Running :command:`getlino configure` without
:option:`--db-port` caused an error :message:`Invalid value for "--db-port":
invalid choice: . (choose from 5432, 3306, 0)`. The :option:`--db-port` option
is not a choice (it must not limited to these values). The :option:`--clone`
option sometimes had `True` as default value.


2019-10-03
==========

.. program:: getlino configure

The :option:`getlino configure --db-port` shows the default ports of databases.


2019-09-19
==========

.. program:: getlino configure

The :option:`getlino configure --clone` option installs all contributor
repositories, i.e. those  required to build the book. Some repositories were
still missing. Fixed.  Also separated the sequence of resulting actions: first
run "git clone" for all repos, then "pip install -e".

2019-09-18
==========

.. program:: getlino configure

Optimized behaviour when running as non-root:
The default value for :option:`--devtools` is now `True` in that case.
:option:`--db-engine` had a wrong default value "sqlite" (must be "sqlite3"),
getlino tried to create the directories given by
:option:`--log-base` and :option:`--backups-base` (which failed because not
running as root).

2019-09-14
==========

.. program:: getlino configure

When running as root, :cmd:`getlino configure` now also creates empty
directories for :option:`--log-base` and :option:`--backups-base` and sets their
permissions.

2019-09-12
===========

When running as root, getlino now also installs the `build-essential` Debian
package because this is maybe needed for installing Python extensions.

getlino didn't set the group owner in some cases (e.g. the lino_local directory
and a project's virtualenv).

:cmd:`getlino configure` now also creates a :xfile:`~/.bash_aliases` file. But
only when you aren't running as root. After running :cmd:`getlino configure` as
root, you may want to run it once more without being root to create a
:xfile:`.bash_aliases` file to your home directory.

Released getlino 19.9.6 to PyPI, immediately followed by a bug-fix release
19.9.7

2019-09-09
==========

Added more demo projects to be used by the getlino configure command.
Released getlino 19.9.5.

2019-09-08
==========

.. program:: getlino configure

Renamed the ``--contrib`` option  to :option:`--clone` because it is also used
when configuring a :term:`demo server`. It means "clone all known repositories
to the --repos-base and install them to the shared-env using :cmd:`pip -e`."
This change requires that you run :cmd:`getlino configure` once after upgrade,
or manually edit your getlino config file.

The configure command now supports :option:`--clone` without specifying a
--repos-base. In that case it uses the `repositories` subdir of the shared-env.

.. program:: getlino startsite

New option :option:`--shared-env` for startsite.  When used with startsite, it
overrides the value specified during configure.

Released getlino 19.9.4 on PyPI.

2019-09-07
==========

Released getlino 19.9.2 on PyPI, followed by a bugfix release 19.9.3.

2019-09-02
==========

Also write logrotate config file for supervisor.

.. program:: getlino configure

Changed some default values
in :cmd:`getlino configure`:
The default value for :option:`--clone` was wrong : when
running as root, it is *not* a contributor environment.
:option:`--shared-env`
and :option:`--repos-base` are now empty when
:envvar:`VIRTUAL_ENV` is not set.
And :option:`--db-engine` is now mysql when running as root.

Released getlino 19.9.0 to PyPI, followed by a bugfix release 19.9.1.


2019-08-27
==========

Released getlino 19.8.1 on PyPI.

2019-08-01
==========

Released getlino 19.8.0 on PyPI.

2019-07-30
==========

Added a first meaningful unit test (:mod:`test_docker_prod`).
